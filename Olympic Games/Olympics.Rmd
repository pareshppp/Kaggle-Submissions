---
title: "Olympic Sports and Medals(1896-2014)"
output: html_notebook
---

More than 35,000 medals have been awarded at the Olympics since 1896. Let's Explore the data.

```{r}
library(readr)
library(dplyr)
library(ggplot2)
summer <- read.csv('summer.csv')
winter <- read.csv('winter.csv')
dictionary <- read.csv('dictionary.csv', stringsAsFactors = F)
```


While exploring the data I noticed that the country names for many country codes were missing. So, I created a separate file (missing-codes.csv) containing the missing countries. I have taken a few liberites while preparing the data to make my work easier, e.g, Soviet Union has been added as 'Russia' even though it contained many countries that later became independent.

Combining the missing data and dictionary.

```{r}
missing.country <- read.csv('missing_codes.csv', stringsAsFactors = F)
country.data <- rbind(select(dictionary, Code, Country), 
                      select(missing.country, Code, Country))
```


## Summer Olympics

First lets check the Summer Olympics Data.


### Cleaning and preparing the data

Replacing the country codes in summer with the country names

```{r}
s.olympics <- tbl_df(summer) %>%
    rename(Code = Country) %>%
    left_join(., country.data, by = 'Code')

colSums(is.na(s.olympics))

```


### Top 10 countries having medals in Summer Olympics

```{r}
top10.countries <- s.olympics %>% 
    group_by(Country) %>%
    mutate(medal.count = n()) %>%
    select(Country, medal.count) %>%
    distinct(Country, medal.count) %>%
    arrange(desc(medal.count)) %>%
    head(10)

# top10.countries

ggplot(data = top10.countries, 
       aes(x = reorder(Country, -medal.count), y = medal.count)) +
    geom_bar(stat = 'identity', width = 0.5, fill = 'green4') +
    geom_label(aes(label = medal.count), nudge_y = 500) +
    labs(title = 'Top 10 Countries - Medal Count in Summer Olympics',
         subtitle = '1986 - 2014') +
    xlab('Country') +
    ylab('Number of Medals') +
    theme(axis.text.x = element_text(angle = 65, vjust = 0.7))
```

